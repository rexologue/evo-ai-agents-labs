name: mcp-finance-server-go
version: 1.0.0
description: |
  MCP сервер для финансовых расчетов: кредиты, вклады и инвестиции (реализация на Go).
  Предоставляет инструменты для расчета графиков платежей по кредитам,
  вкладам с капитализацией и инвестициям с регулярными взносами.
  
  Сервер поддерживает:
  - Расчет аннуитетных и дифференцированных кредитов
  - Расчет вкладов с ежемесячной капитализацией
  - Сравнение типов кредитов
  - Калькулятор инвестиций с регулярными взносами

author: ermadatov@cloud.ru
license: MIT
homepage: https://github.com/cloud-ru/evo-ai-agents-labs/tree/main/lab9-mcp-finance-go

transport:
  type: streamable-http
  endpoint: http://localhost:8000/mcp
  description: |
    Сервер использует streamable-http транспорт для коммуникации через JSON-RPC.
    По умолчанию запускается на порту 8000.

tools:
  - name: loan_schedule_annuity
    description: |
      Аннуитетный кредит: расчёт фиксированного ежемесячного платежа и помесячного графика.
      Инструмент строит таблицу платежей по аннуитетной схеме.
    parameters:
      - name: principal
        type: float
        description: Сумма кредита (> 0, ≤ лимита)
        required: true
      - name: annual_rate_percent
        type: float
        description: Годовая ставка в процентах (0..лимит)
        required: true
      - name: months
        type: int
        description: Срок в месяцах (1..лимит)
        required: true
    returns:
      type: ToolResult
      description: Результат расчета с графиком платежей и сводкой

  - name: loan_schedule_differential
    description: |
      Дифференцированный кредит: постоянная часть тела и уменьшающиеся проценты.
      На выходе — помесячная таблица с полями для каждого месяца.
    parameters:
      - name: principal
        type: float
        description: Сумма кредита (> 0, ≤ лимита)
        required: true
      - name: annual_rate_percent
        type: float
        description: Годовая ставка в процентах (0..лимит)
        required: true
      - name: months
        type: int
        description: Срок в месяцах (1..лимит)
        required: true
    returns:
      type: ToolResult
      description: Результат расчета с графиком платежей и сводкой

  - name: deposit_schedule_compound
    description: |
      Вклад с ежемесячной капитализацией и взносами.
      Строит график для каждого месяца с детализацией баланса и процентов.
    parameters:
      - name: initial_amount
        type: float
        description: Начальная сумма (≥ 0, ≤ лимита)
        required: true
      - name: annual_rate_percent
        type: float
        description: Годовая ставка в процентах (0..лимит)
        required: true
      - name: months
        type: int
        description: Срок в месяцах (1..лимит)
        required: true
      - name: monthly_contribution
        type: float
        description: Ежемесячный взнос (≥ 0, ≤ лимита)
        required: true
      - name: contribution_at_beginning
        type: bool
        description: True — взнос в начале месяца, False — в конце
        required: true
    returns:
      type: ToolResult
      description: Результат расчета с графиком вклада и сводкой

  - name: compare_loan_schedules
    description: |
      Сравнение аннуитетного и дифференцированного кредитов.
      Инструмент сравнивает два типа кредитов с одинаковыми параметрами и показывает
      общую сумму выплат, переплату по процентам, разницу в платежах и преимущества каждого типа.
    parameters:
      - name: principal
        type: float
        description: Сумма кредита (> 0, ≤ лимита)
        required: true
      - name: annual_rate_percent
        type: float
        description: Годовая ставка в процентах (0..лимит)
        required: true
      - name: months
        type: int
        description: Срок в месяцах (1..лимит)
        required: true
    returns:
      type: ToolResult
      description: Результат сравнения двух типов кредитов с рекомендациями

  - name: investment_calculator
    description: |
      Калькулятор инвестиций с регулярными взносами и капитализацией.
      Рассчитывает рост инвестиций с учетом регулярных взносов и сложных процентов.
      Показывает помесячный график роста капитала, накопленные проценты и итоговую сумму.
    parameters:
      - name: initial_amount
        type: float
        description: Начальная сумма инвестиций (≥ 0, ≤ лимита)
        required: true
      - name: annual_rate_percent
        type: float
        description: Годовая доходность в процентах (0..лимит)
        required: true
      - name: months
        type: int
        description: Срок инвестирования в месяцах (1..лимит)
        required: true
      - name: monthly_contribution
        type: float
        description: Ежемесячный взнос (≥ 0, ≤ лимита)
        required: true
      - name: contribution_at_beginning
        type: bool
        description: True — взнос в начале месяца, False — в конце
        required: true
    returns:
      type: ToolResult
      description: Результат расчета инвестиций с графиком роста и метриками (ROI, средняя доходность и т.д.)

observability:
  metrics:
    provider: Prometheus
    endpoint: http://localhost:8000/metrics
    description: |
      Метрики Prometheus доступны по эндпоинту /metrics.
      Отслеживаются: количество вызовов инструментов, ошибки расчетов, вызовы API.
  
  tracing:
    provider: OpenTelemetry
    description: |
      Поддержка распределенного трейсинга через OpenTelemetry.
      Настраивается через переменную окружения OTEL_ENDPOINT.
      Если не задана, используется noop экспортер для локальной разработки.

environment:
  variables:
    - name: PORT
      type: int
      default: 8000
      description: Порт для запуска MCP сервера
      required: false
    
    - name: OTEL_ENDPOINT
      type: string
      default: ""
      description: |
        Endpoint для экспорта трейсов OpenTelemetry (OTLP).
        Если не задан, используется noop экспортер.
      required: false
    
    - name: OTEL_SERVICE_NAME
      type: string
      default: "mcp-finance-server"
      description: Имя сервиса для OpenTelemetry трейсинга
      required: false

installation:
  method: go
  command: |
    go mod download
    go build -o server ./cmd/server
  
  docker:
    description: |
      Сервер может быть запущен в Docker контейнере.
      Используйте Dockerfile для сборки образа.
    command: |
      docker build -t mcp-finance-server-go .
      docker run -p 8000:8000 mcp-finance-server-go

usage:
  start: |
    go run ./cmd/server
  
  docker: |
    docker run -p 8000:8000 -e PORT=8000 mcp-finance-server-go
  
  health_check: |
    curl http://localhost:8000/health
  
  metrics: |
    curl http://localhost:8000/metrics

requirements:
  go: ">=1.21"
  dependencies:
    - github.com/modelcontextprotocol/go-sdk
    - github.com/prometheus/client_golang
    - go.opentelemetry.io/otel
    - github.com/joho/godotenv

examples:
  - name: Расчет аннуитетного кредита
    description: Пример расчета кредита на 1 000 000 руб. под 12% годовых на 12 месяцев
    request:
      tool: loan_schedule_annuity
      parameters:
        principal: 1000000
        annual_rate_percent: 12
        months: 12
  
  - name: Расчет вклада с капитализацией
    description: Пример расчета вклада с начальной суммой 100 000 руб., ставкой 8% и ежемесячными взносами 10 000 руб.
    request:
      tool: deposit_schedule_compound
      parameters:
        initial_amount: 100000
        annual_rate_percent: 8
        months: 12
        monthly_contribution: 10000
        contribution_at_beginning: true
  
  - name: Сравнение типов кредитов
    description: Пример сравнения аннуитетного и дифференцированного кредитов
    request:
      tool: compare_loan_schedules
      parameters:
        principal: 2000000
        annual_rate_percent: 10
        months: 24

tags:
  - finance
  - loans
  - deposits
  - investments
  - calculations
  - mcp
  - go
  - golang
